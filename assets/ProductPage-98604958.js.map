{"version":3,"file":"ProductPage-98604958.js","sources":["../../src/hooks/useLS.ts","../../src/features/products/productForm/ProductForm.tsx","../../src/features/products/productCard/ProductCard.tsx","../../src/features/products/productPage/ProductPage.tsx"],"sourcesContent":["import { useEffect, useState } from 'react';\r\n\r\nfunction getSavedValue<T>(key: string, defaultValue: T): T {\r\n  const savedValue = localStorage.getItem(key);\r\n  return (savedValue !== null ? JSON.parse(savedValue) : defaultValue);\r\n}\r\n\r\nfunction useLocalStorage<T>(key: string, initialValue: T): [T, React.Dispatch<React.SetStateAction<T>>] {\r\n  const [value, setValue] = useState<T>(() => getSavedValue(key, initialValue));\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem(key, JSON.stringify(value));\r\n  }, [key, value]);\r\n\r\n  return [value, setValue];\r\n}\r\n\r\nexport default useLocalStorage;","import React, { ChangeEvent, FC, FormEvent, useState } from \"react\"\r\nimport style from \"./Product.module.css\"\r\nimport { useAppDispatch } from \"../../../app/hooks\"\r\nimport { addProduct } from \"../productAction\"\r\nimport IProductCredentials from \"../types/ProductCredentials\"\r\nimport IProduct from \"../types/Product\"\r\nimport useLocalStorage from \"../../../hooks/useLS\"\r\n\r\nconst ProductForm: FC = () => {\r\n  // const [title, setTitle] = useState(\"\")\r\n  // const [description, setDescription] = useState(\"\")\r\n  // const [category, setCategory] = useState(\"\")\r\n  // const [price, setPrice] = useState(\"\")\r\n  // const [image, setImage] = useState(\"\")\r\n\r\n  const dispatch = useAppDispatch();\r\n  const [error, setError] = useState('');\r\n  \r\n  const [product, setProduct] = useLocalStorage(\"product\",{\r\n    title: \"\",\r\n    description: \"\",\r\n    category: \"\",\r\n    price: \"\",\r\n    image: \"\",\r\n  })\r\n\r\n  const handleChange = (e: ChangeEvent<HTMLInputElement>) => {\r\n    const { name, value } = e.target\r\n\r\n    setProduct({\r\n      ...product,\r\n      [name]: value,\r\n    })\r\n  }\r\n\r\n  function validateInputs(): boolean {\r\n    const linkPattern = /^(https?:\\/\\/)?([\\w.-]+\\.\\w{2,})(\\/\\S*)?$/\r\n\r\n    if (product.title.trim() === \"\") {\r\n      setError(\"title is not valid\")\r\n      return false\r\n    }\r\n    if (product.description.trim() === \"\") {\r\n      setError(\"description is not valid\")\r\n      return false\r\n    }\r\n    if (product.category.trim() === \"\") {\r\n      setError(\"category is not valid\")\r\n      return false\r\n    }\r\n    if (product.price.trim() === \"\" || Number.isNaN(Number(product.price))) {\r\n      setError(\"price is not valid\")\r\n      return false\r\n    }\r\n    if (!linkPattern.test(product.image)) {\r\n      setError(\"url is not valid\")\r\n      return false\r\n    }\r\n    return true\r\n  }\r\n\r\n\r\n  const handleSubmit = (e: FormEvent<HTMLFormElement>) => {\r\n    e.preventDefault()\r\n    setError('');\r\n\r\n    sessionStorage.setItem(\"price\", product.price)\r\n\r\n    console.log(product)\r\n\r\n    // const data: IProductCredentials = {\r\n    //   title,\r\n    //   description,\r\n    //   category,\r\n    //   price: Number(price),\r\n    //   image,\r\n    // }\r\n\r\n    if (validateInputs()) {\r\n    dispatch(addProduct(product))\r\n    }\r\n\r\n    // console.log(data);\r\n  }\r\n\r\n  return (\r\n    <>\r\n    \r\n    <div className={style.formContainer}>\r\n      {/* <h1>Product Form</h1> */}\r\n      <form className={style.form} onSubmit={handleSubmit} action=\"\">\r\n        <label>Add new product</label>\r\n        <input\r\n          name=\"title\"\r\n          onChange={handleChange}\r\n          placeholder=\"title\"\r\n          type=\"text\"\r\n          value={product.title}\r\n        />\r\n        <input\r\n          name=\"description\"\r\n          onChange={handleChange}\r\n          placeholder=\"description\"\r\n          type=\"text\"\r\n          value={product.description}\r\n        />\r\n        <input\r\n          name=\"category\"\r\n          onChange={handleChange}\r\n          placeholder=\"category\"\r\n          type=\"text\"\r\n          value={product.category}\r\n        />\r\n        <input\r\n          name=\"price\"\r\n          onChange={handleChange}\r\n          placeholder=\"price\"\r\n          type=\"text\"\r\n          value={product.price}\r\n        />\r\n        <input\r\n          name=\"image\"\r\n          onChange={handleChange}\r\n          placeholder=\"image\"\r\n          type=\"text\"\r\n          value={product.image}\r\n        />\r\n        <button type=\"submit\" className=\"button\">\r\n          Add file\r\n        </button>\r\n      </form>\r\n    </div>\r\n    <div style={{textAlign: 'center'}}>\r\n        {error && <span style={{color: 'red'}}>{error}</span>}\r\n    </div>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default ProductForm\r\n\r\nfunction setError(arg0: string) {\r\n  throw new Error(\"Function not implemented.\")\r\n}\r\n","import { FC } from \"react\"\r\n\r\nimport styles from \"./ProductCard.module.css\"\r\nimport { Link } from \"react-router-dom\"\r\nimport { useAppDispatch, useAppSelector } from \"../../../app/hooks\"\r\nimport MyButton from \"../../../components/myButton/MyButton\"\r\nimport { deleteProduct } from \"../productAction\"\r\nimport IProduct from \"../types/Product\"\r\nimport { toggleFavorites } from \"../productsSlice\"\r\n\r\nconst ProductCard: FC<IProduct> = ({ id, title, description, image, price }) => {\r\n  const dispatch = useAppDispatch()\r\n\r\n  const {favorites} = useAppSelector(\r\n    (state) =>   state.products\r\n  )\r\n\r\n  return (\r\n    <div>\r\n      <li key={id} className={styles.productCard}>\r\n        <span className={styles.title}>{title}</span>\r\n\r\n        <div className={styles.imgWrapper}>\r\n          <img src={image} alt=\"\" />\r\n        </div>\r\n        <span style={{color: \"green\", fontSize: 40}}>Price: {price} €</span>\r\n\r\n        <svg style={{ cursor: 'pointer' }} onClick={() => dispatch(toggleFavorites(id))} width=\"30px\" height=\"30px\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" fill={favorites.includes(id as number) ? \"#e74c3c\" : 'grey'} >\r\n              <g transform=\"translate(0 -1028.4)\">\r\n                {/* по свойству fill меняем цвет заливки, в зависимости от наличия id в массиве любимых продуктов */}\r\n                <path d=\"m7 1031.4c-1.5355 0-3.0784 0.5-4.25 1.7-2.3431 2.4-2.2788 6.1 0 8.5l9.25 9.8 9.25-9.8c2.279-2.4 2.343-6.1 0-8.5-2.343-2.3-6.157-2.3-8.5 0l-0.75 0.8-0.75-0.8c-1.172-1.2-2.7145-1.7-4.25-1.7z\"  />\r\n              </g>\r\n            </svg>\r\n\r\n            {/* fill={favorites.includes(el.id as number) ? \"#e74c3c\" : 'grey'} */}\r\n\r\n\r\n        <Link to={String(id)}>\r\n          <MyButton text=\"to products page\" />\r\n        </Link>\r\n\r\n        <MyButton text=\"Delete\" onClick={() => dispatch(deleteProduct(id))} />\r\n      </li>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default ProductCard\r\n","import React, { FC, useEffect, useState } from \"react\"\r\nimport styles from \"./ProductPage.module.css\"\r\n\r\nimport { useAppDispatch, useAppSelector } from \"../../../app/hooks\"\r\nimport { loadProducts } from \"../productAction\"\r\nimport ProductForm from \"../productForm/ProductForm\"\r\nimport ProductCard from \"../productCard/ProductCard\"\r\nimport Loader from \"../../../components/loader/Loader\"\r\nimport { motion } from \"framer-motion\"\r\nimport { Navigate } from \"react-router-dom\"\r\n\r\nconst ProductPage: FC = () => {\r\n  // const [products, setProducts] = useState<IProduct[]>([]);\r\n\r\n  // useEffect(() => {\r\n  //   async function GetProducts() {\r\n  //       const resp = await fetch(\"https://fakestoreapi.com/products\");\r\n  //       const respObj = await resp.json();\r\n  //       setProducts(respObj);\r\n  //     }\r\n\r\n  //     GetProducts();\r\n  //   }, []);\r\n\r\n  const dispatch = useAppDispatch()\r\n\r\n  const { products, error, isLoading } = useAppSelector(\r\n    (state) => state.products,\r\n  )\r\n\r\n  const { user } = useAppSelector(\r\n    (state) => state.user,\r\n  )\r\n\r\n  useEffect(() => {\r\n    dispatch(loadProducts())\r\n  }, [])\r\n\r\n  const initialVariant = {\r\n    hidden: { opacity: 1, scale: 0.8 },\r\n    visible: { opacity: 1, scale: 1, transition: { duration: 0.8 } },\r\n  }\r\n\r\n  if (!user) {\r\n    return <Navigate to='../login'/>\r\n  }\r\n  return (\r\n    <motion.div initial=\"hidden\" animate=\"visible\" variants={initialVariant}>\r\n      <ProductForm />\r\n      {isLoading && <Loader />}\r\n      {error && <h4 style={{ color: \"red\" }}>Error {error}</h4>}\r\n      {!isLoading && (\r\n        <ul className={styles.productList}>\r\n          {products.map((el) => (\r\n            <ProductCard\r\n              key={el.id}\r\n              id={el.id}\r\n              title={el.title}\r\n              description={el.description}\r\n              image={el.image}\r\n              price={el.price}\r\n            />\r\n\r\n            // <div>\r\n            //   <li key={el.id} className={styles.productCard}>\r\n            //     <span className={styles.title}>{el.title}</span>\r\n\r\n            //     <div className={styles.imgWrapper}>\r\n            //       <img src={el.image} alt=\"\" />\r\n            //     </div>\r\n            //       <Link to={String(el.id)}>\r\n            //     <MyButton text=\"to product\" />\r\n            //       </Link>\r\n            //   </li>\r\n            // </div>\r\n          ))}\r\n        </ul>\r\n      )}\r\n    </motion.div>\r\n  )\r\n}\r\n\r\nexport default ProductPage\r\n"],"names":["getSavedValue","key","defaultValue","savedValue","useLocalStorage","initialValue","value","setValue","useState","useEffect","ProductForm","dispatch","useAppDispatch","error","setError","product","setProduct","handleChange","e","name","validateInputs","linkPattern","handleSubmit","addProduct","jsxs","Fragment","jsx","style","ProductCard","id","title","description","image","price","favorites","useAppSelector","state","styles","toggleFavorites","Link","MyButton","deleteProduct","ProductPage","products","isLoading","user","loadProducts","initialVariant","motion","Loader","el","Navigate"],"mappings":"8QAEA,SAASA,EAAiBC,EAAaC,EAAoB,CACnD,MAAAC,EAAa,aAAa,QAAQF,CAAG,EAC3C,OAAQE,IAAe,KAAO,KAAK,MAAMA,CAAU,EAAID,CACzD,CAEA,SAASE,EAAmBH,EAAaI,EAA+D,CAChG,KAAA,CAACC,EAAOC,CAAQ,EAAIC,EAAAA,SAAY,IAAMR,EAAcC,EAAKI,CAAY,CAAC,EAE5EI,OAAAA,EAAAA,UAAU,IAAM,CACd,aAAa,QAAQR,EAAK,KAAK,UAAUK,CAAK,CAAC,CAAA,EAC9C,CAACL,EAAKK,CAAK,CAAC,EAER,CAACA,EAAOC,CAAQ,CACzB,CCPA,MAAMG,EAAkB,IAAM,CAO5B,MAAMC,EAAWC,IACX,CAACC,EAAOC,CAAQ,EAAIN,WAAS,EAAE,EAE/B,CAACO,EAASC,CAAU,EAAIZ,EAAgB,UAAU,CACtD,MAAO,GACP,YAAa,GACb,SAAU,GACV,MAAO,GACP,MAAO,EAAA,CACR,EAEKa,EAAgBC,GAAqC,CACzD,KAAM,CAAE,KAAAC,EAAM,MAAAb,GAAUY,EAAE,OAEfF,EAAA,CACT,GAAGD,EACH,CAACI,CAAI,EAAGb,CAAA,CACT,CAAA,EAGH,SAASc,GAA0B,CACjC,MAAMC,EAAc,4CAEpB,OAAIN,EAAQ,MAAM,KAAK,IAAM,IAC3BD,EAAS,oBAAoB,EACtB,IAELC,EAAQ,YAAY,KAAK,IAAM,IACjCD,EAAS,0BAA0B,EAC5B,IAELC,EAAQ,SAAS,KAAK,IAAM,IAC9BD,EAAS,uBAAuB,EACzB,IAELC,EAAQ,MAAM,KAAA,IAAW,IAAM,OAAO,MAAM,OAAOA,EAAQ,KAAK,CAAC,GACnED,EAAS,oBAAoB,EACtB,IAEJO,EAAY,KAAKN,EAAQ,KAAK,EAI5B,IAHLD,EAAS,kBAAkB,EACpB,GAGX,CAGM,MAAAQ,EAAgBJ,GAAkC,CACtDA,EAAE,eAAe,EACjBJ,EAAS,EAAE,EAEI,eAAA,QAAQ,QAASC,EAAQ,KAAK,EAE7C,QAAQ,IAAIA,CAAO,EAUfK,KACKT,EAAAY,EAAWR,CAAO,CAAC,CAC5B,EAKF,OAGES,EAAA,KAAAC,WAAA,CAAA,SAAA,CAAAC,EAAA,IAAC,MAAI,CAAA,UAAWC,EAAM,cAEpB,SAACH,OAAA,OAAA,CAAK,UAAWG,EAAM,KAAM,SAAUL,EAAc,OAAO,GAC1D,SAAA,CAAAI,EAAAA,IAAC,SAAM,SAAe,iBAAA,CAAA,EACtBA,EAAA,IAAC,QAAA,CACC,KAAK,QACL,SAAUT,EACV,YAAY,QACZ,KAAK,OACL,MAAOF,EAAQ,KAAA,CACjB,EACAW,EAAA,IAAC,QAAA,CACC,KAAK,cACL,SAAUT,EACV,YAAY,cACZ,KAAK,OACL,MAAOF,EAAQ,WAAA,CACjB,EACAW,EAAA,IAAC,QAAA,CACC,KAAK,WACL,SAAUT,EACV,YAAY,WACZ,KAAK,OACL,MAAOF,EAAQ,QAAA,CACjB,EACAW,EAAA,IAAC,QAAA,CACC,KAAK,QACL,SAAUT,EACV,YAAY,QACZ,KAAK,OACL,MAAOF,EAAQ,KAAA,CACjB,EACAW,EAAA,IAAC,QAAA,CACC,KAAK,QACL,SAAUT,EACV,YAAY,QACZ,KAAK,OACL,MAAOF,EAAQ,KAAA,CACjB,QACC,SAAO,CAAA,KAAK,SAAS,UAAU,SAAS,SAEzC,WAAA,CAAA,CAAA,CACF,CACF,CAAA,QACC,MAAI,CAAA,MAAO,CAAC,UAAW,QACnB,EAAA,SAAAF,GAAUa,EAAAA,IAAA,OAAA,CAAK,MAAO,CAAC,MAAO,KAAK,EAAI,UAAM,CAAA,EAClD,CACA,CAAA,CAAA,CAEJ,+GC/HME,EAA4B,CAAC,CAAE,GAAAC,EAAI,MAAAC,EAAO,YAAAC,EAAa,MAAAC,EAAO,MAAAC,KAAY,CAC9E,MAAMtB,EAAWC,IAEX,CAAC,UAAAsB,GAAaC,EACjBC,GAAYA,EAAM,QAAA,EAGrB,aACG,MACC,CAAA,SAAAZ,EAAA,KAAC,KAAY,CAAA,UAAWa,EAAO,YAC7B,SAAA,CAAAX,EAAA,IAAC,OAAK,CAAA,UAAWW,EAAO,MAAQ,SAAMP,EAAA,EAEtCJ,EAAA,IAAC,MAAI,CAAA,UAAWW,EAAO,WACrB,SAACX,EAAAA,IAAA,MAAA,CAAI,IAAKM,EAAO,IAAI,EAAA,CAAG,CAC1B,CAAA,EACAR,OAAC,QAAK,MAAO,CAAC,MAAO,QAAS,SAAU,EAAK,EAAA,SAAA,CAAA,UAAQS,EAAM,IAAA,EAAE,QAE5D,MAAI,CAAA,MAAO,CAAE,OAAQ,WAAa,QAAS,IAAMtB,EAAS2B,EAAgBT,CAAE,CAAC,EAAG,MAAM,OAAO,OAAO,OAAO,QAAQ,YAAY,MAAM,6BAA6B,QAAQ,MAAM,KAAMK,EAAU,SAASL,CAAY,EAAI,UAAY,OAChO,SAACH,EAAAA,IAAA,IAAA,CAAE,UAAU,uBAEX,SAAAA,EAAAA,IAAC,QAAK,EAAE,8LAAA,CAAgM,CAC1M,CAAA,EACF,EAKJA,EAAAA,IAACa,EAAK,CAAA,GAAI,OAAOV,CAAE,EACjB,SAACH,EAAAA,IAAAc,EAAA,CAAS,KAAK,kBAAA,CAAmB,CACpC,CAAA,EAEAd,EAAAA,IAACc,EAAS,CAAA,KAAK,SAAS,QAAS,IAAM7B,EAAS8B,EAAcZ,CAAE,CAAC,EAAG,CAAA,GAtB7DA,CAuBT,CACF,CAAA,CAEJ,EClCMa,EAAkB,IAAM,CAa5B,MAAM/B,EAAWC,IAEX,CAAE,SAAA+B,EAAU,MAAA9B,EAAO,UAAA+B,CAAc,EAAAT,EACpCC,GAAUA,EAAM,QAAA,EAGb,CAAE,KAAAS,GAASV,EACdC,GAAUA,EAAM,IAAA,EAGnB3B,EAAAA,UAAU,IAAM,CACdE,EAASmC,GAAc,CACzB,EAAG,CAAE,CAAA,EAEL,MAAMC,EAAiB,CACrB,OAAQ,CAAE,QAAS,EAAG,MAAO,EAAI,EACjC,QAAS,CAAE,QAAS,EAAG,MAAO,EAAG,WAAY,CAAE,SAAU,GAAM,CAAA,EAGjE,OAAKF,EAIHrB,OAACwB,EAAO,IAAP,CAAW,QAAQ,SAAS,QAAQ,UAAU,SAAUD,EACvD,SAAA,CAAArB,EAAA,IAAChB,EAAY,EAAA,EACZkC,SAAcK,EAAO,EAAA,EACrBpC,GAAUW,EAAAA,KAAA,KAAA,CAAG,MAAO,CAAE,MAAO,KAAS,EAAA,SAAA,CAAA,SAAOX,CAAA,EAAM,EACnD,CAAC+B,GACAlB,EAAAA,IAAC,KAAG,CAAA,UAAWW,EAAO,YACnB,SAAAM,EAAS,IAAKO,GACbxB,EAAA,IAACE,EAAA,CAEC,GAAIsB,EAAG,GACP,MAAOA,EAAG,MACV,YAAaA,EAAG,YAChB,MAAOA,EAAG,MACV,MAAOA,EAAG,KAAA,EALLA,EAAG,EAoBX,CAAA,EACH,CAEJ,CAAA,CAAA,EAlCOxB,EAAA,IAACyB,EAAS,CAAA,GAAG,UAAU,CAAA,CAoClC"}